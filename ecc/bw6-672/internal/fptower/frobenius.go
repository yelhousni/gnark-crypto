// Copyright 2020 ConsenSys AG
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package fptower

import "github.com/consensys/gnark-crypto/ecc/bw6-672/fp"

// Frobenius set z in E6 to Frobenius(x), return z
func (z *E6) Frobenius(x *E6) *E6 {
	a := fp.Element{
		8127924044626390019,
		14491772207729554195,
		16716438288424669826,
		7026446034040394055,
		3865670002852136315,
		1494661498942185023,
		1852785321280926540,
		552802473061884231,
		4997155499784565439,
		14807307534390102016,
		663205297,
	}
	b := fp.Element{
		11811787588143456059,
		1584381794286108144,
		13407550264291146327,
		228484992245867000,
		4374298734032990259,
		3181435302248239017,
		14706496923169967406,
		2803036459937125532,
		13437326375068592652,
		10607799632259891155,
		1599510096,
	}
	c := fp.Element{
		13230255091504931020,
		14849145826634702503,
		14929798223562933414,
		8502682085176910787,
		4637830298936418148,
		5742745567510804005,
		6808398056203351885,
		13864538687579740714,
		14417433084989935915,
		14703449732633412017,
		657762522,
	}
	ac := fp.Element{
		13344413026831010615,
		18089370454804403307,
		1786640064861736411,
		16970508022573034884,
		17674583777625269782,
		14198660005140932633,
		13491131338787126270,
		5135007859191695132,
		9026466488504181139,
		103857801756689998,
		5442775,
	}
	bc := fp.Element{
		16914118635021997060,
		1941755413191256452,
		11620910199429409915,
		1704721043382383732,
		5146459030117272092,
		7429519370816857999,
		1215365584382841135,
		16114772674454982016,
		4410859886564411512,
		10503941830503201157,
		1594067321,
	}

	z.B0.A0.Set(&x.B0.A0)
	z.B0.A1.Mul(&x.B0.A1, &a)
	z.B0.A2.Mul(&x.B0.A2, &b)

	z.B1.A0.Mul(&x.B1.A0, &c)
	z.B1.A1.Mul(&x.B1.A1, &ac)
	z.B1.A2.Mul(&x.B1.A2, &bc)

	return z
}
